<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>🕌 Daily Deen Dashboard</title>

    <style>
      @import url("https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Scheherazade+New:wght@400;700&display=swap");

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      :root {
        --bg: #fafaf9;
        --card-bg: #ffffff;
        --text: #1a1a1a;
        --text-muted: #6b7280;
        --primary: #2c3e50;
        --accent: #d4a574;
        --accent-light: #f0e6d8;
        --border: #e5e7eb;
        --shadow: rgba(0, 0, 0, 0.08);
        --gold-subtle: rgba(212, 165, 116, 0.15);
      }

      [data-theme="dark"] {
        --bg: #1a1a1a;
        --card-bg: #2d2d2d;
        --text: #f5f5f5;
        --text-muted: #a0a0a0;
        --accent: #d4a574;
        --accent-light: #3a3a3a;
        --border: #404040;
        --shadow: rgba(0, 0, 0, 0.3);
        --gold-subtle: rgba(212, 165, 116, 0.1);
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      body {
        font-family: "Segoe UI", -apple-system, BlinkMacSystemFont, sans-serif;
        background: var(--bg);
        color: var(--text);
        line-height: 1.6;
        padding: 0;
        min-height: 100vh;
        transition: background 0.3s ease, color 0.3s ease;
      }

      .arabic-text {
        font-family: "Amiri", "Scheherazade New", "Traditional Arabic",
          "Arabic Typesetting", serif;
        font-size: 1.6rem;
        line-height: 2.2;
        direction: rtl;
        text-align: right;
        font-weight: 400;
      }

      .islamic-pattern {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        height: 200px;
        background: linear-gradient(
          135deg,
          var(--accent-light) 0%,
          var(--bg) 100%
        );
        z-index: 0;
        opacity: 0.4;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
        position: relative;
        z-index: 1;
      }

      header {
        text-align: center;
        padding: 40px 20px;
        margin-bottom: 40px;
        animation: fadeIn 0.6s ease;
      }

      h1 {
        font-size: 2.8rem;
        margin-bottom: 10px;
        color: var(--primary);
        font-weight: 300;
        letter-spacing: -0.5px;
      }

      h1::first-letter {
        color: var(--accent);
      }

      .subtitle {
        color: var(--text-muted);
        font-size: 1rem;
        margin-bottom: 25px;
      }

      .controls {
        display: flex;
        gap: 12px;
        justify-content: center;
        flex-wrap: wrap;
      }

      button {
        padding: 10px 24px;
        border: 1px solid var(--border);
        border-radius: 8px;
        background: var(--card-bg);
        color: var(--text);
        cursor: pointer;
        font-size: 0.95rem;
        transition: all 0.2s ease;
        box-shadow: 0 2px 4px var(--shadow);
      }

      button:hover {
        border-color: var(--accent);
        transform: translateY(-1px);
        box-shadow: 0 4px 8px var(--shadow);
      }

      /* Hero Section - Prayer Times */
      .hero-section {
        background: var(--card-bg);
        border-radius: 16px;
        padding: 35px;
        margin-bottom: 30px;
        box-shadow: 0 4px 12px var(--shadow);
        border-left: 4px solid var(--accent);
        animation: fadeIn 0.8s ease;
      }

      .hero-section h2 {
        font-size: 1.8rem;
        color: var(--primary);
        margin-bottom: 25px;
        font-weight: 400;
      }

      .hero-section h2::before {
        content: "📿 ";
      }

      .prayer-times {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
      }

      .prayer-item {
        text-align: center;
        padding: 20px;
        background: var(--gold-subtle);
        border-radius: 12px;
        transition: all 0.2s ease;
      }

      .prayer-item:hover {
        background: var(--accent-light);
        transform: translateY(-2px);
      }

      .prayer-name {
        font-size: 0.85rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 8px;
      }

      .prayer-time {
        font-size: 1.5rem;
        font-weight: 600;
        color: var(--accent);
      }

      /* Two Column Layout */
      .two-column {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 30px;
        margin-bottom: 30px;
      }

      .content-card {
        background: var(--card-bg);
        border-radius: 16px;
        padding: 30px;
        box-shadow: 0 4px 12px var(--shadow);
        animation: fadeIn 1s ease;
      }

      .content-card h3 {
        font-size: 1.4rem;
        color: var(--primary);
        margin-bottom: 20px;
        font-weight: 400;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .ayah-text {
        font-style: italic;
        font-size: 1.15rem;
        line-height: 1.9;
        color: var(--text);
        padding: 20px;
        background: var(--gold-subtle);
        border-radius: 12px;
        border-left: 3px solid var(--accent);
        margin-bottom: 15px;
      }

      .reference {
        color: var(--accent);
        font-size: 0.95rem;
        font-weight: 500;
      }

      /* Dhikr Counter Section */
      .dhikr-section {
        background: var(--card-bg);
        border-radius: 16px;
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: 0 4px 12px var(--shadow);
        animation: fadeIn 1.2s ease;
      }

      .dhikr-section h3 {
        font-size: 1.4rem;
        color: var(--primary);
        margin-bottom: 25px;
        font-weight: 400;
        text-align: center;
      }

      .counter-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 20px;
        margin-bottom: 20px;
      }

      .counter-item {
        text-align: center;
        padding: 25px 15px;
        background: var(--gold-subtle);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
      }

      .counter-item:hover {
        background: var(--accent-light);
        border-color: var(--accent);
      }

      .counter-item:active {
        transform: scale(0.95);
      }

      .counter-number {
        font-size: 2.5rem;
        font-weight: 600;
        color: var(--accent);
        display: block;
        margin-bottom: 8px;
      }

      .counter-label {
        font-size: 0.9rem;
        color: var(--text-muted);
      }

      /* Info Banner */
      .info-banner {
        background: linear-gradient(
          135deg,
          var(--accent-light),
          var(--card-bg)
        );
        border-radius: 16px;
        padding: 25px 30px;
        margin-bottom: 30px;
        border-left: 4px solid var(--accent);
        animation: fadeIn 1.4s ease;
      }

      .date-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: 20px;
      }

      .date-item {
        flex: 1;
        min-width: 200px;
      }

      .date-label {
        font-size: 0.85rem;
        color: var(--text-muted);
        text-transform: uppercase;
        letter-spacing: 1px;
        margin-bottom: 5px;
      }

      .date-value {
        font-size: 1.2rem;
        color: var(--primary);
        font-weight: 500;
      }

      /* Names Grid */
      .names-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 12px;
      }

      .name-badge {
        padding: 12px 18px;
        background: var(--card-bg);
        border: 1px solid var(--border);
        border-radius: 8px;
        font-size: 0.95rem;
        color: var(--text);
        text-align: center;
        transition: all 0.2s ease;
      }

      .name-badge:hover {
        border-color: var(--accent);
        background: var(--gold-subtle);
      }

      footer {
        text-align: center;
        margin-top: 50px;
        padding: 30px 20px;
        color: var(--text-muted);
        font-size: 0.9rem;
        border-top: 1px solid var(--border);
      }

      .error {
        color: #dc2626;
        font-size: 0.95rem;
        padding: 12px;
        background: rgba(220, 38, 38, 0.1);
        border-radius: 8px;
        border-left: 3px solid #dc2626;
      }

      .loading {
        color: var(--text-muted);
        font-style: italic;
      }

      @media (max-width: 968px) {
        .two-column {
          grid-template-columns: 1fr;
        }
        .counter-grid {
          grid-template-columns: 1fr;
        }
        .prayer-times {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 640px) {
        h1 {
          font-size: 2rem;
        }
        .prayer-times {
          grid-template-columns: 1fr;
        }
        .arabic-text {
          font-size: 1.3rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="islamic-pattern"></div>
    <div class="container">
      <header>
        <h1>Daily Deen Dashboard</h1>
        <div class="subtitle" id="dates">Loading dates...</div>
        <div class="controls">
          <button onclick="refreshContent()">🔄 Refresh Content</button>
          <button onclick="toggleDarkMode()">🌙 Dark Mode</button>
        </div>
      </header>

      <!-- Islamic Date Info Banner -->
      <div class="info-banner">
        <div class="date-row" id="islamic-info">
          <div class="loading">Loading Islamic calendar...</div>
        </div>
      </div>

      <!-- Prayer Times Hero Section -->
      <section class="hero-section">
        <h2>Prayer Times - London, UK</h2>
        <div id="prayer-times" class="loading">Loading prayer times...</div>
      </section>

      <!-- Daily Dua -->
      <section class="content-card" style="margin-bottom: 30px">
        <h3>🤲 Daily Dua</h3>
        <div id="daily-dua" class="loading">Loading dua...</div>
      </section>

      <!-- Verse & Hadith Two Column -->
      <div class="two-column">
        <div class="content-card">
          <h3>📖 Verse of the Day</h3>
          <div id="ayah" class="loading">Loading ayah...</div>
        </div>

        <div class="content-card">
          <h3>💬 Daily Hadith</h3>
          <div id="hadith" class="loading">Loading hadith...</div>
        </div>
      </div>

      <!-- Daily Tafsir -->
      <section class="content-card" style="margin-bottom: 30px">
        <h3>📚 Daily Tafsir</h3>
        <div id="tafsir" class="loading">Loading tafsir...</div>
      </section>

      <!-- Dhikr Counter -->
      <section class="dhikr-section">
        <h3>📿 Dhikr Counter</h3>
        <div class="counter-grid">
          <div class="counter-item" onclick="incrementCounter('subhanallah')">
            <span class="counter-number" id="count-subhanallah">0</span>
            <span class="counter-label">SubhanAllah</span>
          </div>
          <div class="counter-item" onclick="incrementCounter('alhamdulillah')">
            <span class="counter-number" id="count-alhamdulillah">0</span>
            <span class="counter-label">Alhamdulillah</span>
          </div>
          <div class="counter-item" onclick="incrementCounter('allahuakbar')">
            <span class="counter-number" id="count-allahuakbar">0</span>
            <span class="counter-label">Allahu Akbar</span>
          </div>
        </div>
        <button onclick="resetCounters()" style="width: 100%; padding: 12px">
          Reset Counters
        </button>
      </section>

      <!-- 99 Names -->
      <section class="content-card">
        <h3>✨ 99 Names of Allah</h3>
        <div class="names-grid" id="allah-names">
          <div class="loading">Loading names...</div>
        </div>
      </section>

      <footer>
        <div>Last updated: <span id="timestamp">...</span></div>
      </footer>
    </div>

    <script>
      // Static hadith collection (fallback for daily rotation)
      const hadiths = [
        {
          text: "The best among you are those who have the best manners and character.",
          reference: "Sahih Bukhari 3559",
        },
        {
          text: "Kindness is a mark of faith, and whoever is not kind has no faith.",
          reference: "Sahih Muslim",
        },
        {
          text: "A good word is charity.",
          reference: "Sahih Bukhari, Sahih Muslim",
        },
        {
          text: "The strong person is not the one who can wrestle others, but the one who controls himself when angry.",
          reference: "Sahih Bukhari 6114",
        },
        {
          text: "Make things easy and do not make them difficult, cheer the people up and do not scare them.",
          reference: "Sahih Bukhari 69",
        },
        {
          text: "None of you truly believes until he loves for his brother what he loves for himself.",
          reference: "Sahih Bukhari 13",
        },
        {
          text: "The believer does not slander, curse, or speak in an obscene or foul manner.",
          reference: "Sunan al-Tirmidhi 1977",
        },
      ];

      // Initialize dark mode from localStorage
      function initDarkMode() {
        const isDark = localStorage.getItem("darkMode") === "true";
        if (isDark) document.documentElement.setAttribute("data-theme", "dark");
      }

      // Toggle dark mode and save preference
      function toggleDarkMode() {
        const current = document.documentElement.getAttribute("data-theme");
        const newTheme = current === "dark" ? "" : "dark";
        document.documentElement.setAttribute("data-theme", newTheme);
        localStorage.setItem("darkMode", newTheme === "dark");
      }

      // Fetch and display dates (Gregorian + Hijri)
      async function loadDates() {
        try {
          const today = new Date();
          const gregorian = today.toLocaleDateString("en-GB", {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
          });

          document.getElementById("dates").innerHTML = gregorian;
        } catch (error) {
          document.getElementById("dates").innerHTML =
            new Date().toLocaleDateString("en-GB", {
              weekday: "long",
              year: "numeric",
              month: "long",
              day: "numeric",
            });
        }
      }

      // Fetch and display prayer times for London
      async function loadPrayerTimes() {
        const el = document.getElementById("prayer-times");
        try {
          const today = new Date();
          const res = await fetch(
            `https://api.aladhan.com/v1/timingsByCity?city=London&country=UK&method=2&date=${today.getDate()}-${
              today.getMonth() + 1
            }-${today.getFullYear()}`
          );
          const data = await res.json();
          const timings = data.data.timings;

          const prayers = [
            { name: "Fajr", time: timings.Fajr },
            { name: "Sunrise", time: timings.Sunrise },
            { name: "Dhuhr", time: timings.Dhuhr },
            { name: "Asr", time: timings.Asr },
            { name: "Maghrib", time: timings.Maghrib },
            { name: "Isha", time: timings.Isha },
          ];

          let html = '<div class="prayer-times">';
          prayers.forEach((prayer) => {
            html += `
              <div class="prayer-item">
                <div class="prayer-name">${prayer.name}</div>
                <div class="prayer-time">${prayer.time}</div>
              </div>
            `;
          });
          html += "</div>";
          el.innerHTML = html;
        } catch (error) {
          el.innerHTML =
            '<div class="error">Failed to load prayer times. Please check your connection.</div>';
        }
      }

      // Fetch and display random Qur'an ayah with translation
      async function loadAyah() {
        const el = document.getElementById("ayah");
        try {
          // Fetch random ayah number first
          const randomRes = await fetch(
            "https://api.alquran.cloud/v1/ayah/random"
          );
          const randomData = await randomRes.json();
          const ayahNumber = randomData.data.number;

          // Fetch both Arabic and English translation
          const res = await fetch(
            `https://api.alquran.cloud/v1/ayah/${ayahNumber}/editions/quran-uthmani,en.sahih`
          );
          const data = await res.json();

          const arabic = data.data[0];
          const translation = data.data[1];

          el.innerHTML = `
            <div class="arabic-text" style="margin-bottom: 20px;">
              ${arabic.text}
            </div>
            <div class="ayah-text" style="font-style: italic; font-size: 1.05rem; margin-bottom: 15px;">
              "${translation.text}"
            </div>
            <div class="reference">— Surah ${arabic.surah.englishName} (${arabic.surah.number}:${arabic.numberInSurah})</div>
          `;
        } catch (error) {
          el.innerHTML =
            '<div class="error">Failed to load ayah. Please try again later.</div>';
        }
      }

      // Display daily hadith (rotates based on day of year)
      function loadHadith() {
        const el = document.getElementById("hadith");
        try {
          // Get day of year for consistent daily rotation
          const now = new Date();
          const start = new Date(now.getFullYear(), 0, 0);
          const diff = now - start;
          const dayOfYear = Math.floor(diff / (1000 * 60 * 60 * 24));
          const index = dayOfYear % hadiths.length;
          const hadith = hadiths[index];

          el.innerHTML = `
                    <div class="ayah-text">"${hadith.text}"</div>
                    <div class="reference">— ${hadith.reference}</div>
                `;
        } catch (error) {
          el.innerHTML = '<div class="error">Failed to load hadith.</div>';
        }
      }

      // Refresh ayah and hadith without page reload
      async function refreshContent() {
        document.getElementById("ayah").innerHTML =
          '<div class="loading">Loading ayah...</div>';
        document.getElementById("hadith").innerHTML =
          '<div class="loading">Loading hadith...</div>';
        document.getElementById("allah-names").innerHTML =
          '<div class="loading">Loading names...</div>';
        document.getElementById("tafsir").innerHTML =
          '<div class="loading">Loading tafsir...</div>';
        document.getElementById("daily-dua").innerHTML =
          '<div class="loading">Loading dua...</div>';
        await loadAyah();
        loadHadith();
        loadAllahNames();
        await loadTafsir();
        await loadDailyDua();
        updateTimestamp();
      }

      // Load daily dua from GitHub open source
      async function loadDailyDua() {
        const el = document.getElementById("daily-dua");
        try {
          // Fetch from Hisnul Muslim (Fortress of the Muslim) JSON on GitHub
          const res = await fetch(
            "https://raw.githubusercontent.com/osamahafez/hisnul-muslim/main/data/en.json"
          );
          const data = await res.json();

          // Get day of year for daily rotation
          const now = new Date();
          const dayOfYear = Math.floor(
            (now - new Date(now.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24)
          );
          const duaIndex = dayOfYear % data.length;
          const dua = data[duaIndex];

          el.innerHTML = `
            <div style="margin-bottom: 15px;">
              <strong style="color: var(--accent); font-size: 1.1rem;">${
                dua.category || "Daily Dua"
              }</strong>
            </div>
            <div class="arabic-text" style="margin-bottom: 15px;">
              ${dua.arabic}
            </div>
            ${
              dua.transliteration
                ? `
              <div style="color: var(--text-muted); font-style: italic; margin-bottom: 10px; font-size: 0.95rem;">
                ${dua.transliteration}
              </div>
            `
                : ""
            }
            <div class="ayah-text" style="font-style: italic; font-size: 1.05rem; margin-bottom: 10px;">
              "${dua.translation}"
            </div>
            ${
              dua.reference
                ? `<div class="reference">${dua.reference}</div>`
                : ""
            }
          `;
        } catch (error) {
          // Fallback to static duas if API fails
          const fallbackDuas = [
            {
              arabic:
                "رَبَّنَا آتِنَا فِي الدُّنْيَا حَسَنَةً وَفِي الْآخِرَةِ حَسَنَةً وَقِنَا عَذَابَ النَّارِ",
              transliteration:
                "Rabbana atina fid-dunya hasanatan wa fil-akhirati hasanatan waqina 'adhaban-nar",
              translation:
                "Our Lord, give us in this world [that which is] good and in the Hereafter [that which is] good and protect us from the punishment of the Fire.",
              reference: "Quran 2:201",
            },
            {
              arabic: "رَبِّ اشْرَحْ لِي صَدْرِي وَيَسِّرْ لِي أَمْرِي",
              transliteration: "Rabbi ishrah lee sadree wa yassir lee amree",
              translation:
                "My Lord, expand for me my breast [with assurance] and ease for me my task.",
              reference: "Quran 20:25-26",
            },
          ];

          const now = new Date();
          const dayOfYear = Math.floor(
            (now - new Date(now.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24)
          );
          const dua = fallbackDuas[dayOfYear % fallbackDuas.length];

          el.innerHTML = `
            <div class="arabic-text" style="margin-bottom: 15px;">
              ${dua.arabic}
            </div>
            <div style="color: var(--text-muted); font-style: italic; margin-bottom: 10px; font-size: 0.95rem;">
              ${dua.transliteration}
            </div>
            <div class="ayah-text" style="font-style: italic; font-size: 1.05rem; margin-bottom: 10px;">
              "${dua.translation}"
            </div>
            <div class="reference">${dua.reference}</div>
          `;
        }
      }

      // Load daily tafsir from Quran.com API (Ibn Kathir)
      async function loadTafsir() {
        const el = document.getElementById("tafsir");

        try {
          // Get a random verse for daily tafsir (rotating through popular verses)
          const importantVerses = [1, 255, 286, 1901, 6236, 6100, 5672]; // Al-Fatiha:1, Ayatul Kursi, etc.
          const now = new Date();
          const dayOfYear = Math.floor(
            (now - new Date(now.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24)
          );
          const verseNumber =
            importantVerses[dayOfYear % importantVerses.length];

          // Fetch verse info first
          const verseRes = await fetch(
            `https://api.quran.com/api/v4/verses/by_key/${verseNumber}?language=en&words=false&translations=131`
          );
          const verseData = await verseRes.json();
          const verse = verseData.verse;

          // Fetch tafsir (169 = Ibn Kathir English)
          const tafsirRes = await fetch(
            `https://api.quran.com/api/v4/quran/tafsirs/169?verse_key=${verse.verse_key}`
          );
          const tafsirData = await tafsirRes.json();
          const tafsir = tafsirData.tafsirs[0];

          // Get translation
          const translation =
            verse.translations && verse.translations[0]
              ? verse.translations[0].text
              : "";

          el.innerHTML = `
            <div style="margin-bottom: 15px;">
              <strong style="color: var(--accent); font-size: 1.1rem;">Surah ${
                verse.verse_key
              }</strong>
            </div>
            <div class="arabic-text" style="margin-bottom: 15px;">
              ${verse.text_uthmani}
            </div>
            <div style="font-style: italic; color: var(--text-muted); margin-bottom: 15px;">
              "${translation}"
            </div>
            <div style="line-height: 1.8; color: var(--text); background: var(--gold-subtle); padding: 20px; border-radius: 12px; border-left: 3px solid var(--accent);">
              <strong style="color: var(--accent); display: block; margin-bottom: 10px;">Tafsir Ibn Kathir:</strong>
              ${tafsir.text.substring(0, 500)}...
            </div>
          `;
        } catch (error) {
          // Fallback to static tafsir if API fails
          const fallbackTafsir = [
            {
              ayah: "Surah Al-Fatiha (1:5)",
              arabic: "إِيَّاكَ نَعْبُدُ وَإِيَّاكَ نَسْتَعِينُ",
              translation:
                "You alone we worship, and You alone we ask for help.",
              tafsir:
                "This verse emphasizes the exclusivity of worship to Allah alone (Tawheed). By saying 'You alone we worship,' we declare that all forms of worship are for Allah only. 'You alone we ask for help' means we rely on Allah for assistance in all matters, both worldly and religious.",
            },
            {
              ayah: "Surah Al-Baqarah (2:286)",
              arabic: "لَا يُكَلِّفُ اللَّهُ نَفْسًا إِلَّا وُسْعَهَا",
              translation:
                "Allah does not burden a soul beyond that it can bear.",
              tafsir:
                "This verse brings immense comfort to believers. Allah, in His infinite wisdom and mercy, knows the capacity of each soul and never burdens it with more than it can handle. This doesn't mean life will be easy, but it means that whatever trials we face, we have been given the strength to endure them.",
            },
          ];

          const now = new Date();
          const dayOfYear = Math.floor(
            (now - new Date(now.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24)
          );
          const tafsir = fallbackTafsir[dayOfYear % fallbackTafsir.length];

          el.innerHTML = `
            <div style="margin-bottom: 15px;">
              <strong style="color: var(--accent); font-size: 1.1rem;">${tafsir.ayah}</strong>
            </div>
            <div class="arabic-text" style="margin-bottom: 15px;">
              ${tafsir.arabic}
            </div>
            <div style="font-style: italic; color: var(--text-muted); margin-bottom: 15px;">
              "${tafsir.translation}"
            </div>
            <div style="line-height: 1.8; color: var(--text); background: var(--gold-subtle); padding: 20px; border-radius: 12px; border-left: 3px solid var(--accent);">
              ${tafsir.tafsir}
            </div>
          `;
        }
      }

      // Load Islamic calendar information
      async function loadIslamicInfo() {
        const el = document.getElementById("islamic-info");
        try {
          const today = new Date();
          const gregorian = today.toLocaleDateString("en-GB", {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
          });

          const res = await fetch(
            `https://api.aladhan.com/v1/gToH/${today.getDate()}-${
              today.getMonth() + 1
            }-${today.getFullYear()}`
          );
          const data = await res.json();
          const hijri = data.data.hijri;

          let holidayHTML = "";
          if (hijri.holidays && hijri.holidays.length > 0) {
            holidayHTML = `
              <div class="date-item" style="flex: 100%; margin-top: 15px; padding: 15px; background: var(--gold-subtle); border-radius: 10px; border-left: 3px solid var(--accent);">
                <div class="date-label">🌟 Special Occasion</div>
                <div class="date-value" style="color: var(--accent);">${hijri.holidays.join(
                  ", "
                )}</div>
              </div>
            `;
          }

          el.innerHTML = `
            <div class="date-item">
              <div class="date-label">Gregorian Date</div>
              <div class="date-value">${gregorian}</div>
            </div>
            <div class="date-item">
              <div class="date-label">Hijri Date</div>
              <div class="date-value">${hijri.day} ${hijri.month.en} ${hijri.year} AH</div>
            </div>
            <div class="date-item">
              <div class="date-label">Arabic</div>
              <div class="date-value" style="direction: rtl;">${hijri.day} ${hijri.month.ar} ${hijri.year}</div>
            </div>
            ${holidayHTML}
          `;
        } catch (error) {
          el.innerHTML =
            '<div class="error">Failed to load Islamic calendar info.</div>';
        }
      }

      // Dhikr counter functions
      function incrementCounter(type) {
        const countEl = document.getElementById(`count-${type}`);
        let count = parseInt(localStorage.getItem(`dhikr-${type}`) || "0");
        count++;
        countEl.textContent = count;
        localStorage.setItem(`dhikr-${type}`, count);

        // Add animation effect
        countEl.style.transform = "scale(1.3)";
        setTimeout(() => (countEl.style.transform = "scale(1)"), 200);
      }

      function resetCounters() {
        ["subhanallah", "alhamdulillah", "allahuakbar"].forEach((type) => {
          localStorage.setItem(`dhikr-${type}`, "0");
          document.getElementById(`count-${type}`).textContent = "0";
        });
      }

      function loadCounters() {
        ["subhanallah", "alhamdulillah", "allahuakbar"].forEach((type) => {
          const count = localStorage.getItem(`dhikr-${type}`) || "0";
          document.getElementById(`count-${type}`).textContent = count;
        });
      }

      // Display 99 Names of Allah (showing a few daily)
      function loadAllahNames() {
        const names = [
          "Ar-Rahman (The Most Merciful)",
          "Ar-Rahim (The Most Compassionate)",
          "Al-Malik (The King)",
          "Al-Quddus (The Most Holy)",
          "As-Salam (The Source of Peace)",
          "Al-Mu'min (The Granter of Security)",
          "Al-Muhaymin (The Guardian)",
          "Al-Aziz (The Almighty)",
          "Al-Jabbar (The Compeller)",
          "Al-Mutakabbir (The Supreme)",
          "Al-Khaliq (The Creator)",
          "Al-Bari (The Evolver)",
          "Al-Musawwir (The Fashioner)",
          "Al-Ghaffar (The Forgiver)",
          "Al-Qahhar (The Subduer)",
          "Al-Wahhab (The Bestower)",
          "Ar-Razzaq (The Provider)",
          "Al-Fattah (The Opener)",
          "Al-Alim (The All-Knowing)",
          "Al-Qabid (The Constrictor)",
          "Al-Basit (The Expander)",
          "Al-Khafid (The Abaser)",
          "Ar-Rafi (The Exalter)",
          "Al-Mu'izz (The Giver of Honor)",
          "Al-Mudhill (The Giver of Dishonor)",
          "As-Sami (The All-Hearing)",
          "Al-Basir (The All-Seeing)",
          "Al-Hakam (The Judge)",
          "Al-Adl (The Just)",
          "Al-Latif (The Subtle One)",
          "Al-Khabir (The All-Aware)",
          "Al-Halim (The Forbearing)",
          "Al-Azim (The Magnificent)",
          "Al-Ghafur (The Forgiving)",
        ];

        const el = document.getElementById("allah-names");
        const now = new Date();
        const dayOfYear = Math.floor(
          (now - new Date(now.getFullYear(), 0, 0)) / (1000 * 60 * 60 * 24)
        );
        const startIndex = (dayOfYear * 2) % names.length;
        const dailyNames = [];

        for (let i = 0; i < 9; i++) {
          dailyNames.push(names[(startIndex + i) % names.length]);
        }

        el.innerHTML = dailyNames
          .map((name) => `<div class="name-badge">${name}</div>`)
          .join("");
      }

      // Update timestamp in footer
      function updateTimestamp() {
        const now = new Date().toLocaleString("en-GB", {
          hour: "2-digit",
          minute: "2-digit",
          day: "2-digit",
          month: "short",
          year: "numeric",
        });
        document.getElementById("timestamp").textContent = now;
      }

      // Initialize app on page load
      (async function init() {
        initDarkMode();
        updateTimestamp();
        loadCounters();
        await loadDates();
        await loadIslamicInfo();
        await loadPrayerTimes();
        loadDailyDua();
        await loadAyah();
        loadHadith();
        await loadTafsir();
        loadAllahNames();
      })();
    </script>
  </body>
</html>
